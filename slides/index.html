<!doctype html>
<html lang="it">

<head>
    <meta charset="utf-8">

    <title>Robo – Modern Task Runner for PHP</title>

    <meta name="description" content="Robo is a task runner for PHP.">
    <meta name="author" content="Luca Cracco (craccoluca@gmail.com)">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style"
          content="black-translucent">

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/blood.css" id="theme">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">

        <section data-background="images/slide_front.jpg"
                 data-background-size="auto 80%">
        </section>

        <!-- Home -->
        <section>
            <section>
                <h1>Robo</h1>
                <h3>Modern Task Runner for PHP</h3>
            </section>
            <section>
                <h3>Luca Cracco</h3>
                <img src="images/me.jpg"
                     width="30%" style="float: right; margin: 20px;">
                <p style="width: 60%;padding-top: 6%">
                    Freelance & Drupal Developer<br/>
                    <a href="https://twitter.com/luca_cracco">@luca_cracco</a>
                    <br/>
                    <a href="https://github.com/lucacracco">github.com/lucacracco</a>
                </p>
            </section>
        </section>

        <!-- "Cos'è Robo" slides -->
        <section>
            <section>
                <h2>Che cos'è Robo</h2>
                <ul>
                    <li>Robo è un <a href="#/1/2">task runner</a></li>
                    <li>E' scritto in PHP con una programmazione orientata agli
                        oggetti
                    </li>
                    <li>Ha a disposizione moltissimi task/comandi per lo
                        sviluppo,
                        test, distribuzione, ecc..
                    </li>
                </ul>
            </section>
            <section>
                <h3>Task Runners</h3>
                <p>
                    Sono tools che permetto di automatizzare le operazioni più
                    riccorenti; sia semplici operazioni di
                    minificazione del css sia compilazione e pubblicazione di
                    codice
                </p>
                <p>
                    Tra i più conosciuti troviamo
                    <a href="http://buildbot.net/">Buildbot</a>,
                    <a href="https://jenkins.io/">Jenkins</a>,
                    .. ma anche <a href="https://gruntjs.com/">Grunt</a>,
                    <a href="http://gulpjs.com/">Gulp</a>, ...
                </p>
            </section>
            <section>
                <h3>Task Runner PHP</h3>
                <ul>
                    <li><a href="https://taskphp.github.io/">Task PHP</a></li>
                    <li><a href="http://bldr.io/">BLDR</a></li>
                    <li><a href="https://github.com/rocketeers/rocketeer/">Rocketter</a>
                    </li>
                </ul>
                <aside class="notes">
                    <p>Task php</p>
                    <ul>
                        <li>Leverage PHP come linguaggio di scripting, e come
                            piattaforma di scelta.
                        </li>
                        <li>Impiega componenti di Symfony</li>
                        <li>Utilizza i plugin per estendere</li>
                    </ul>
                    <p>BLDR</p>
                    <ul>
                        <li>Povero, semplice come sistema</li>
                        <li>Utilizza Yaml, JSON, XML, PHP, or INI for configs
                        </li>
                    </ul>
                    <p>Rocketter</p>
                    <ul>
                        <li>inspired by the Laravel Framework</li>
                        <li>Versatile (multi connesioni db), Veloce,
                            Modulare(ogni parte del framework è
                            sovrascrivibile), Preconfigurato, Potete(server
                            check, rollbacks)
                        </li>
                    </ul>
                </aside>
            </section>
        </section>

        <!-- "Usare Robo" slides -->
        <section>
            <section>
                <h2>Usare Robo per</h2>
                <ul>
                    <li>Eseguire comandi</li>
                    <li>Lanciare test</li>
                    <li>Automatizzare le opereazioni più comuni</li>
                    <li>Eseguire attività parallele</li>
                    <li>Percepire cambiamenti sul filesystem</li>
                    <li>Inizializzare ambienti e progetti</li>
                </ul>
            </section>
            <section>
                <h2>..perchè Robo?</h2>
                <ul>
                    <li>E' scritto in PHP ad oggetti</li>
                    <li>Supporto per i comandi: robo list</li>
                    <li>Comandi con convalida, colori ANSI, ecc..</li>
                    <li>Si può installare con Composer per il progetto</li>
                    <li>Vi sono un sacco di task già pronti</li>
                </ul>
            </section>
        </section>

        <!-- Installare Robo Slides -->
        <section>
            <section>
                <h2>Installazione</h2>
                <h4>Composer</h4>
                <p>Aggiungendolo al <i>composer.json</i> del progetto</p>
                <pre><code class="json" data-trim>
                    require-dev: {
                        "consolidation/robo": "^1.0.0"
                    }
                </code></pre>
                <p>o installandolo globalmente</p>
                <pre><code class="zsh" data-trim>
                    composer global require consolidation/robo
                </code></pre>
            </section>
            <section>
                <h2>Installazione</h2>
                <h4>Phar</h4>
                <pre><code class="zsh" data-trim>
                    wget http://robo.li/robo.phar
                </code></pre>
                <p>o scaricandolo via HTTPS da <a
                        href="https://github.com/consolidation/Robo/releases">GitHub
                    releases</a></p>
                <p>Oppure installandolo in /usr/bin</p>
                <pre><code class="zsh" data-trim>
                    sudo chmod +x robo.phar && mv robo.phar /usr/bin/robo
                </code></pre>
            </section>
        </section>

        <section>
            <section>
                <h2>Per iniziare...</h2>
                <p>
                    Creiamo il nostro <strong>Robofile.php</strong> con
                </p>
                <pre><code class="zsh" data-trim>
                    cd mio_progetto
                    robo init
                </code></pre>
                <p>Ed ecco il file:</p>
                <pre><code class="php" data-trim>
/**
 * This is project's console commands
 * configuration for Robo task runner.
 *
 * @see http://robo.li/
 */
class RoboFile extends \Robo\Tasks
{
    // define public methods as commands
}
                </code></pre>
            </section>
            <section>
                <h2>Comandi</h2>
                <pre><code class="php" data-trim>
                    class RoboFile extends \Robo\Tasks {

                        function hello($world) {
                            $this->say("Hello, $world");
                        }
                    }
                </code></pre>
                <p>Eseguendo:</p>
                <pre><code class="zsh" data-trim>
                    robo hello Paolo
                    ➜ Hello, Paolo
                </code></pre>
                <aside class="notes">
                    Tutti i metodi pubblici della classe RoboFile saranno
                    trattati come comandi. È possibile eseguirli
                    dall'interfaccia di comando direttamente.
                </aside>
            </section>

            <section>
                <h2>Argomenti</h2>
                <pre><code class="php" data-trim>
                    class RoboFile extends \Robo\Tasks {

                        function helloOne($world = "Francesco") {
                            $this->say("Hello, $world");
                        }

                        function helloMulti(array $world) {
                            $this->say("Hello, " . implode(', ', $world));
                        }
                    }
                </code></pre>
                <p>Eseguendo:</p>
                <pre><code class="zsh" data-trim>
                    robo hello:one
                    ➜ Hello, Francesco

                    robo hello:multi Paolo Francesco
                    ➜ Hello, Paolo Francesco
                </code></pre>
                <aside class="notes">
                    Tutti i parametri del metodo senza valori di default
                    vengono trattati come argomenti obbligatori.
                    Nel nostro esempio di comando richiede un argomento.
                    Se si passa un valore predefinito al parametro
                    l'argomento diventa facoltativo.

                    Per accettare più, argomenti variabili, definire un
                    parametro come un array; Robo poi passare tutti gli
                    argomenti CLI in questa variabile:
                </aside>
            </section>

            <section>
                <h2>Opzioni</h2>
                <pre><code class="php" data-trim>
                    function hello($opts = ['silent' => false]) {
                        if (!$opts['silent']) $this->say("Hello, world");
                    }
                </code></pre>
                <p>Eseguendo:</p>
                <pre><code class="zsh" data-trim>
                    robo hello
                    ➜ Hello, world

                    robo hello --silent
                    ➜
                </code></pre>
                <aside class="notes">
                    Per definire le opzioni di comando è necessario definire
                    l'ultimo parametro del metodo come un array associativo
                    dove le chiavi definiscono i nomi delle opzioni e dei
                    valori forniscono valori di default di ogni opzione
                </aside>
            </section>
        </section>

        <section>
            <section>
                <h2>Robo Tasks</h2>
                <p>
                    Base Tasks,
                    FileSystem Tasks,
                    File Tasks,
                    Composer Tasks,
                    VCS Tasks,
                    Development Tasks,
                    Assets Tasks,
                    Archive Tasks,
                    SSH, Rsync Tasks,
                    Testing Tasks,
                    NPM Tasks,
                    Bower Tasks,
                    Gulp Tasks,
                    Docker Tasks,
                    ApiGen Tasks, e molti altri in <a
                        href="https://packagist.org/search/?type=robo-tasks">Packagist.org</a>
                </p>
                <aside class="notes">
                    e molti altri cercando "type=robo-tasks"
                </aside>
            </section>

            <section>
                <h2>Includere un Task</h2>
                <p>Aggiungerlo al progetto</p>
                <pre><code class="zsh" data-trim>
                composer require boedah/robo-drush
                </code></pre>
                <p>Richiamarlo nel RoboFile</p>
                <pre><code class="php" data-trim>
                    class RoboFile extends \Robo\Tasks {

                        use \Boedah\Robo\Task\Drush\loadTasks;

                        public function test() {
                            // ...
                        }
                    }
                </code></pre>
                <aside class="notes">
                    e molti altri cercando "type=robo-tasks"
                </aside>
            </section>

            <section>
                <h2>Creare un Task</h2>
                <h4>Trait loadTasks.php</h4>
                <pre><code class="php" data-trim>
                    namespace MyAssetTasks;

                    trait loadTasks {

                        /**
                         * Example task to compile assets
                         *
                         * @param string $pathToCompileAssets
                         * @return \MyAssetTasks\CompileAssets
                         */
                        protected function taskCompileAssets($path = null) {
                            // Always construct your tasks with the `task()` task builder.
                            return $this->task(CompileAssets::class, $path);
                        }
                    }
                </code></pre>
            </section>

            <section>
                <h2>Creare un Task</h2>
                <h4>Task implementation</h4>
                <pre><code class="php" data-trim>
                    class CompileAssets implements \Robo\Contract\TaskInterface {

                        // configuration params
                        protected $path;
                        protected $to;
                        function __construct($path){
                            $this->path = $path;
                        }

                        function to($filename){
                            $this->to = $filename;
                            // must return $this
                            return $this;
                        }

                        // must implement Run
                        function run(){
                            //....
                        }
                    }
                </code></pre>
            </section>

        </section>

        <section>
            <section>
                <h2>IO: Robo\Output</h2>
                <p>Stampare messaggi</p>
                <pre><code class="php" data-trim>
                    $this->say("Hello");
                </code></pre>
                <p>Oppure interagire:</p>
                <pre><code class="php" data-trim>
                    $name = $this->ask("What is your name?");
                </code></pre>
                <aside class="notes">
                    Vi sono ulteriori trait/metodi per: askDefault, askHidden, e
                    confirm.
                </aside>
            </section>

            <section>
                <h2>Task vs Stack</h2>
                <p>
                    Le classi Stack contengono un insieme di task da eseguire
                    uno dopo l'altro. Inoltre può essere configurato per
                    bloccarsi
                    al primo errore che incontra senza proseguire con gli altri
                    task.
                </p>
                <pre><code class="php" data-trim>
                $this->stopOnFail(true);
                </code></pre>
            </section>

            <section>
                <h2>Stack vs Collection</h2>
                <p>
                    Robo offre delle <em>collection</em> di task che permettono
                    il
                    rilevamento degli errori e il recupero/rollback. Se uno dei
                    task della <em>collection</em> va in errore, l'operazione
                    viene
                    interrotta; attività di rollback può essere quindi eseguita
                    per ripristinare il sistema allo stato originale.
                </p>
                <aside class="notes">
                    Quando i task vengono aggiunti alla collection, la loro
                    esecuzione è differita fino a quando il metodo run() non
                    viene chiamato.

                    E' possibile aggiungere ulteriori task prima o dopo il
                    riferimento ad un task.
                </aside>
            </section>
        </section>

        <section>
            <section>
                <h2>RoboFiles multipli</h2>
                <p>
                    E' possibile fornire il maggior numero di classi di comandi
                    (Robofile) direttamente al costruttore <b>RoboRunner</b>
                </p>
                <pre><code class="php" data-trim>
                    $commandClasses = [
                        \MyProject\Commands\BuildCommands::class,
                        \MyProject\Commands\DeployCommands::class
                    ];
                    $statusCode = \Robo\Robo::run(
                        $_SERVER['argv'],
                        $commandClasses,
                        'MyAppName',
                        '0.0.0-alpha0'
                    );
                    exit($statusCode);
                </code></pre>
            </section>
        </section>

        <section>
            <section>
                <h2>Drupal8 & Composer</h2>
                <ul>
                    <li>
                        <a href="https://www.drupal.org/docs/develop/using-composer/using-composer-with-drupal">
                            Usare Composer con Drupal
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/drupal-composer/drupal-project">
                            Composer template per progetti Drupal
                        </a>
                    </li>
                </ul>
            </section>
            <section>
                <h2>Robo & Drupal</h2>
                <p>
                    Integrazione Robo con Drush:<br/>
                    <a href="https://github.com/boedah/robo-drush">boedah/robo-drush</a>
                </p>
                <pre><code class="php" data-trim>
                    $this->taskDrushStack()
                        ->drupalRootDirectory('/var/www/html/some-site')
                        ->uri('sub.example.com')
                        ->maintenanceOn()
                        ->updateDb()
                        ->revertAllFeatures()
                        ->maintenanceOff()
                        ->run();
                </code></pre>
            </section>
        </section>

        <section>
            <section>
                <h2>Robo Drupal8 Builder</h2>
                <ul>
                    <li>Robo</li>
                    <li>Drush</li>
                    <li>Tasks Robo/Drush</li>
                    <li>Yaml Files ➜ Configurations</li>
                </ul>
                <p>
                    <a href="https://github.com/lucacracco/robo-drupal8/">
                        Work in progress.. <br/>
                        github.com/lucacracco/robo-drupal8
                    </a>
                </p>
            </section>
            <section>
                <h2>YAML Configurations</h2>
                <pre><code class="yaml" data-trim>
# Enviroment
environment: local

# Base Path
base_path: /var/www/html

# Path to drush
drush_path: ./vendor/bin/drush

# Domani used
domain: 'http://test.dd'

# Database Configuration
database:
  url: 'mysql://drupal:drupal@mysql_test:3306/drupal'
  prefix: ''
  namespace: 'Drupal\\Core\\Database\\Driver\\mysql'
  driver: 'mysql'

# Site configuration
site_configuration:
  mail: site@example.it
  name: 'Test - Drupal Day Roma 2017 | Drupal8'
  locale: en
  profile: standard
  uri: test
  sub_dir: test
  config_dir: '../config/test'
  root: 'web'
  site_root: 'web'
....
                </code></pre>
            </section>
            <section>
                <h2>Tasks custom</h2>
                <pre><code class="php" data-trim>
public function deploy($opts = self::OPTS) {

    $this->say("Deploy");

    // Init parameters.
    $this->init($opts['environment'], $opts['site']);

    // Execute functions.
    $this->backupDatabase();
    $this->importConfig();
    $this->rebuildCache();
    $this->entityUpdates();
    $this->coreCron();
}
                </code></pre>
            </section>
            <section>
                <h2>Robo Commands</h2>
                <pre><code class="zsh" data-trim>
➜  vendor/bin/robo list
Robo version 1.0.5

Available commands:
  deploy                   Deploy.
  help                     Displays help for a command
  list                     Lists commands
 build
  build:conf               Build a site from configuration files.
  build:from-database      Build an existing site by importing the database.
  build:new                Build a site from scratch.
 configuration
  configuration:export     Export configuration after clear cache.
  configuration:import     Import configuration.
 features
  features:import          Import features.
  features:import-all      Import All features.
 fixtures
  fixtures:import          Import All features.
 migration
  migration:import         Perform one or more migration processes.
  migration:install        Migration install modules dependencies.
  migration:reset-status   Reset a active migration's status to idle.
  migration:rollback       Migrate rollback.
  migration:status         Migrate status.
  migration:uninstall      Migration uninstall modules dependencies.
                </code></pre>
            </section>
            <section
                    data-background-video="video/record_robo_exec.mkv"
                    data-background-size="auto 90%">
                <!-- Nothing. See video in background -->
            </section>
        </section>

        <section>
            <section>
                <h1>DRUPALDAY</h1>
                <h3>ROMA 2017</h3>
                <img src="images/organizzato_da.png"
                     alt="Organizzato da.."
                     class="plain"
                     style="background:none">
            </section>
        </section>

        <section data-background="images/slide_back.jpg"
                 data-background-size="auto 90%">
        </section>

    </div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>

    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1024, // 960
        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // Bounds for smallest/largest possible scale to apply to content
        minScale: 0.2,
        maxScale: 1.5,

        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
            {
                src: 'lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/highlight/highlight.js',
                async: true,
                callback: function () {
                    hljs.initHighlightingOnLoad();
                }
            },
            {src: 'plugin/zoom-js/zoom.js', async: true},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });

</script>

</body>
</html>
